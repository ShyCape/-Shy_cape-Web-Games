<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Blaster Clicker Deluxe</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #e0f0f7; /* Lighter background */
            margin: 0;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.5em;
        }
        .game-container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 900px; /* Slightly wider */
            box-sizing: border-box;
            text-align: center;
            border: 1px solid #ddd;
        }
        .stats {
            margin-bottom: 25px;
            font-size: 1.2em;
            color: #555;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .stats div {
            padding: 5px 15px;
            background-color: #ecf0f1;
            border-radius: 5px;
            margin: 5px;
            min-width: 150px;
            text-align: center;
        }
        #ad-area {
            min-height: 250px;
            border: 2px dashed #aed6f1;
            padding: 15px;
            margin: 25px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            background-color: #fdfefe;
            border-radius: 8px;
            overflow: auto;
            max-height: 400px;
        }
        .simulated-ad {
            width: 160px;
            height: 110px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 3px 3px 8px rgba(0,0,0,0.2);
            transition: transform 0.15s ease-out, opacity 0.3s ease-in;
            border-radius: 6px;
            padding: 10px;
            color: #555;
            font-weight: bold;
        }
        .simulated-ad:hover {
            transform: translateY(-3px) scale(1.03);
        }
        .simulated-ad.clicked {
            opacity: 0;
            transform: scale(0.2);
            transition: opacity 0.3s ease-in, transform 0.3s ease-in;
        }
        .simulated-ad .close-btn {
            position: absolute;
            top: 5px;
            right: 8px;
            font-size: 0.8em;
            font-weight: bold;
            color: #c0392b;
            cursor: pointer;
            z-index: 10;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 3px;
            padding: 0 4px;
        }
        .simulated-ad .ad-content {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.1em;
            padding: 5px;
        }
        .simulated-ad .ad-value {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        .upgrades {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        .upgrades button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 4px #2980b9;
        }
        .upgrades button.prestige {
            background-color: #8e44ad; /* Purple for prestige */
            box-shadow: 0 4px #6c3483;
        }
        .upgrades button:hover {
            background-color: #2980b9;
        }
        .upgrades button.prestige:hover {
            background-color: #6c3483;
        }
        .upgrades button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #2980b9;
        }
        .upgrades button.prestige:active {
            transform: translateY(2px);
            box-shadow: 0 2px #6c3483;
        }
        .upgrades button:disabled {
            background-color: #cccccc;
            box-shadow: 0 4px #bbbbbb;
            cursor: not-allowed;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Ad Blaster Clicker Deluxe</h1>
        <div class="stats">
            <div>Points: <span id="points">0</span></div>
            <div>Ads Clicked: <span id="ads-clicked">0</span></div>
            <div>Click Power: <span id="click-power">1</span> (Clears <span id="ads-cleared-per-click">1</span> ads)</div>
            <div>Ad Spawn Rate: <span id="spawn-rate">2.0</span>s</div>
            <div>Prestige Level: <span id="prestige-level">0</span></div>
            <div>Auto-Clickers: <span id="auto-clickers">0</span></div>
        </div>

        <div id="ad-area">
            </div>

        <div class="upgrades">
            <h2>Upgrades</h2>
            <button id="upgrade-click-btn">Upgrade Click Power (Cost: <span id="cost-click">50</span> points)</button>
            <button id="upgrade-spawn-btn">Increase Ad Spawn Rate (Cost: <span id="cost-spawn">100</span> points)</button>
            <button id="buy-autoclicker-btn">Buy Auto-Clicker (Cost: <span id="cost-autoclicker">10</span> points)</button>
            <button id="prestige-btn" class="prestige">Prestige! (Req: <span id="prestige-req">10,000</span> points)</button>
        </div>
    </div>

    <script>
        // --- Game Variables ---
        let points = 0;
        let adsClicked = 0;
        let clickPower = 1;         // Points earned per ad click / Number of ads removed
        let baseAdSpawnRate = 3000; // Milliseconds (3 seconds) - Initial slower spawn rate
        let currentAdSpawnRate = baseAdSpawnRate;
        let adCounter = 0;          // To give unique IDs to ads
        let adSpawnInterval;        // Holds the interval ID for ad generation
        let prestigeLevel = 0;      // How many times player has prestiged
        let autoClickers = 0;       // Number of auto-clickers owned
        let autoClickInterval;      // Interval for auto-clicking

        // Upgrade Costs (dynamic)
        let upgradeClickCost = 50;
        let upgradeSpawnCost = 100;
        let autoClickerCost = 10;
        const PRESTIGE_REQUIREMENT = 10000; // Points needed to prestige

        // Ad Definitions: rarity (0-1, sum must be 1), value, colors, messages
        const adTypes = [
            { name: "Common Ad", rarity: 0.65, value: 1,
              bgColor: "#f9e79f", borderColor: "#f1c40f", messages: ["Click Me!", "Get Points Now!"] },
            { name: "Uncommon Ad", rarity: 0.30, value: 5,
              bgColor: "#a9dfbf", borderColor: "#2ecc71", messages: ["Limited Offer!", "Big Bonus!"] },
            { name: "Rare Ad", rarity: 0.04, value: 25,
              bgColor: "#aed6f1", borderColor: "#3498db", messages: ["Mega Points!", "Jackpot!"] },
            { name: "Epic Ad", rarity: 0.009, value: 50,
              bgColor: "#ebb6d6", borderColor: "#e75cbb", messages: ["EPIC AD!", "MASSIVE PAYOUT!"] },
            { name: "Legendary Ad", rarity: 0.001, value: 100,
              bgColor: "#e74c3c", borderColor: "#c0392b", messages: ["ULTRA RARE!", "Insane Payout!"] }
        ];

        // --- DOM Elements ---
        const pointsDisplay = document.getElementById('points');
        const adsClickedDisplay = document.getElementById('ads-clicked');
        const clickPowerDisplay = document.getElementById('click-power');
        const adsClearedPerClickDisplay = document.getElementById('ads-cleared-per-click');
        const spawnRateDisplay = document.getElementById('spawn-rate');
        const prestigeLevelDisplay = document.getElementById('prestige-level');
        const autoClickersDisplay = document.getElementById('auto-clickers');
        const adArea = document.getElementById('ad-area');
        const upgradeClickBtn = document.getElementById('upgrade-click-btn');
        const upgradeSpawnBtn = document.getElementById('upgrade-spawn-btn');
        const buyAutoclickerBtn = document.getElementById('buy-autoclicker-btn');
        const prestigeBtn = document.getElementById('prestige-btn');
        const costClickSpan = document.getElementById('cost-click');
        const costSpawnSpan = document.getElementById('cost-spawn');
        const costAutoclickerSpan = document.getElementById('cost-autoclicker');
        const prestigeReqSpan = document.getElementById('prestige-req');

        // --- Functions ---

        // Updates all on-screen displays
        function updateDisplay() {
            pointsDisplay.textContent = points.toFixed(0);
            adsClickedDisplay.textContent = adsClicked;
            clickPowerDisplay.textContent = clickPower;
            adsClearedPerClickDisplay.textContent = clickPower;
            spawnRateDisplay.textContent = (currentAdSpawnRate / 1000).toFixed(1);
            prestigeLevelDisplay.textContent = prestigeLevel;
            autoClickersDisplay.textContent = autoClickers;

            // Update button texts and enable/disable states
            costClickSpan.textContent = upgradeClickCost;
            costSpawnSpan.textContent = upgradeSpawnCost;
            costAutoclickerSpan.textContent = autoClickerCost;
            prestigeReqSpan.textContent = PRESTIGE_REQUIREMENT;

            upgradeClickBtn.disabled = points < upgradeClickCost;
            upgradeSpawnBtn.disabled = points < upgradeSpawnCost;
            buyAutoclickerBtn.disabled = points < autoClickerCost;
            prestigeBtn.disabled = points < PRESTIGE_REQUIREMENT;
        }

        // Selects an ad type based on rarity
        function selectRandomAdType() {
            let rand = Math.random();
            let cumulativeRarity = 0;
            for (const type of adTypes) {
                cumulativeRarity += type.rarity;
                if (rand < cumulativeRarity) {
                    return type;
                }
            }
            return adTypes[0]; // Fallback
        }

        // Creates and appends a new simulated ad to the ad area
        function generateAd() {
            adCounter++;
            const adType = selectRandomAdType();
            const ad = document.createElement('div');
            ad.classList.add('simulated-ad');
            ad.dataset.id = adCounter;
            ad.dataset.value = adType.value;

            // Apply specific ad type styling and content
            ad.style.backgroundColor = adType.bgColor;
            ad.style.borderColor = adType.borderColor;
            const randomMessage = adType.messages[Math.floor(Math.random() * adType.messages.length)];
            ad.innerHTML = `<span class="close-btn">X</span><div class="ad-content">${randomMessage}</div><div class="ad-value">+${adType.value} Points</div>`;

            // Event listener for clicking the ad
            ad.addEventListener('click', (event) => {
                if (event.target.classList.contains('close-btn')) {
                    return;
                }
                processAdClick(ad); // Use a shared function for manual and auto clicks
            });

            // Event listener for the close button within the ad
            const closeBtn = ad.querySelector('.close-btn');
            closeBtn.addEventListener('click', (event) => {
                event.stopPropagation();
                ad.classList.add('clicked');
                setTimeout(() => ad.remove(), 300);
            });

            adArea.appendChild(ad);
            updateDisplay();
        }

        // Function to process an ad click (used by both manual and auto-clickers)
        function processAdClick(adElement) {
            if (!adElement || adElement.classList.contains('clicked')) {
                return;
            }

            const clickedAdValue = parseInt(adElement.dataset.value);
            points += clickedAdValue * clickPower;
            adsClicked += clickPower;

            const currentAds = Array.from(adArea.querySelectorAll('.simulated-ad'))
                                .filter(ad => !ad.classList.contains('clicked'));

            let removedCount = 0;
            
            // Prioritize removing the clicked ad first
            adElement.classList.add('clicked');
            removedCount++;
            setTimeout(() => adElement.remove(), 300);

            // Then remove additional ads based on clickPower, prioritizing highest value
            currentAds.sort((a, b) => parseInt(b.dataset.value) - parseInt(a.dataset.value));

            for (let i = 0; i < clickPower - 1 && currentAds.length > 0; i++) {
                let adToProcess = null;
                for(let j = 0; j < currentAds.length; j++) {
                    if (currentAds[j] !== adElement && !currentAds[j].classList.contains('clicked')) {
                        adToProcess = currentAds[j];
                        break;
                    }
                }

                if (adToProcess) {
                    adToProcess.classList.add('clicked');
                    removedCount++;
                    setTimeout(() => adToProcess.remove(), 300);
                } else {
                    break;
                }
            }
            updateDisplay();
        }

        // Auto-clicker logic
        function performAutoClick() {
            if (autoClickers === 0) return;

            let availableAds = Array.from(adArea.querySelectorAll('.simulated-ad'))
                                    .filter(ad => !ad.classList.contains('clicked'));

            availableAds.sort((a, b) => parseInt(b.dataset.value) - parseInt(a.dataset.value));

            for (let i = 0; i < autoClickers; i++) {
                if (availableAds.length > 0) {
                    let adToClick = availableAds.shift();
                    processAdClick(adToClick);
                } else {
                    break;
                }
            }
        }


        // --- Upgrade Functions ---

        function upgradeClickPower() {
            if (points >= upgradeClickCost) {
                points -= upgradeClickCost;
                clickPower++;
                upgradeClickCost = Math.floor(upgradeClickCost * 1.5);
                updateDisplay();
            }
        }

        function upgradeAdSpawnRate() {
            if (points >= upgradeSpawnCost) {
                points -= upgradeSpawnCost;
                // CORRECTED: Decrease currentAdSpawnRate to make ads spawn faster
                currentAdSpawnRate = Math.max(200, currentAdSpawnRate - 200); // Decrease by 200ms, with a minimum of 200ms
                
                clearInterval(adSpawnInterval);
                adSpawnInterval = setInterval(generateAd, currentAdSpawnRate);
                updateDisplay();
            }
        }

        function buyAutoClicker() {
            if (points >= autoClickerCost) {
                points -= autoClickerCost;
                autoClickers++;
                autoClickerCost = Math.floor(autoClickerCost * 1.75);
                updateDisplay();

                if (autoClickers === 1) { // Start interval only once
                    autoClickInterval = setInterval(performAutoClick, 10000); // Every 10 seconds
                }
            }
        }

        function prestigeGame() {
            if (points >= PRESTIGE_REQUIREMENT) {
                if (!confirm(`Are you sure you want to Prestige? You will reset to 0 points, but gain a permanent bonus! Requires ${PRESTIGE_REQUIREMENT} points.`)) {
                    return;
                }

                prestigeLevel++;

                points = 0;
                adsClicked = 0;
                clickPower = 1 + (prestigeLevel * 0.5);
                autoClickers = 0;
                
                baseAdSpawnRate = 3000;
                // CORRECTED: Subtract from baseAdSpawnRate to make it faster with prestige
                currentAdSpawnRate = Math.max(200, baseAdSpawnRate - (prestigeLevel * 50)); // Faster base spawn rate with prestige, min 200ms
                
                upgradeClickCost = 50;
                upgradeSpawnCost = 100;
                autoClickerCost = 10;

                adArea.innerHTML = '';
                
                clearInterval(adSpawnInterval);
                clearInterval(autoClickInterval);
                
                adSpawnInterval = setInterval(generateAd, currentAdSpawnRate);

                for (let i = 0; i < 3; i++) {
                    generateAd();
                }

                updateDisplay();
                alert(`Prestiged to Level ${prestigeLevel}! Enjoy your bonus!`);
            } else {
                alert(`You need ${PRESTIGE_REQUIREMENT - points} more points to Prestige!`);
            }
        }

        // --- Event Listeners for Upgrades ---
        upgradeClickBtn.addEventListener('click', upgradeClickPower);
        upgradeSpawnBtn.addEventListener('click', upgradeAdSpawnRate);
        buyAutoclickerBtn.addEventListener('click', buyAutoClicker);
        prestigeBtn.addEventListener('click', prestigeGame);

        // --- Initial Game Setup ---
        function initGame() {
            clickPower = 1 + (prestigeLevel * 0.5);
            // CORRECTED: Subtract from baseAdSpawnRate here too
            currentAdSpawnRate = Math.max(200, baseAdSpawnRate - (prestigeLevel * 50));
            autoClickers = 0;
            
            updateDisplay();
            for (let i = 0; i < 3; i++) {
                generateAd();
            }
            adSpawnInterval = setInterval(generateAd, currentAdSpawnRate);
        }

        initGame();
    </script>
</body>
</html>
